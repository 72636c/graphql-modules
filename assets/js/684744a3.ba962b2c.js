"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2930],{4137:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return d}});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=o.createContext({}),u=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=u(e.components);return o.createElement(l.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=u(t),d=r,b=m["".concat(l,".").concat(d)]||m[d]||c[d]||i;return t?o.createElement(b,a(a({ref:n},p),{},{components:t})):o.createElement(b,a({ref:n},p))}));function d(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,a=new Array(i);a[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,a[1]=s;for(var u=2;u<i;u++)a[u]=t[u];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},496:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return u},toc:function(){return p},default:function(){return m}});var o=t(7462),r=t(3366),i=(t(7294),t(4137)),a=["components"],s={id:"communication-between-modules",title:"Communication Between Modules",sidebar_label:"Communication Between Modules"},l=void 0,u={unversionedId:"recipes/communication-between-modules",id:"version-legacy/recipes/communication-between-modules",isDocsHomePage:!1,title:"Communication Between Modules",description:"While basically modules should be a standalone unit of code, it's not possible to create completely standalone modules.",source:"@site/versioned_docs/version-legacy/recipes/communication-between-modules.md",sourceDirName:"recipes",slug:"/recipes/communication-between-modules",permalink:"/docs/legacy/recipes/communication-between-modules",editUrl:"https://github.com/Urigo/graphql-modules/edit/master/website/versioned_docs/version-legacy/recipes/communication-between-modules.md",tags:[],version:"legacy",frontMatter:{id:"communication-between-modules",title:"Communication Between Modules",sidebar_label:"Communication Between Modules"},sidebar:"version-legacy/docs",previous:{title:"Load Your Schema and Resolvers",permalink:"/docs/legacy/recipes/load-your-schema"},next:{title:"Microservices",permalink:"/docs/legacy/recipes/microservices"}},p=[{value:"Using Direct Dependency Injection",id:"using-direct-dependency-injection",children:[]},{value:"Using Injection Tokens",id:"using-injection-tokens",children:[]},{value:"Using a Communication Bridge: PubSub",id:"using-a-communication-bridge-pubsub",children:[{value:"Existing Implementations for PubSub",id:"existing-implementations-for-pubsub",children:[]}]}],c={toc:p};function m(e){var n=e.components,t=(0,r.Z)(e,a);return(0,i.kt)("wrapper",(0,o.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"While basically modules should be a standalone unit of code, it's not possible to create ",(0,i.kt)("strong",{parentName:"p"},"completely")," standalone modules.\nModules need to interact with each other, execute functions, send messages and more.\nGraphQL Modules provides multiple ways of doing it, and you should pick the right one according to your needs."),(0,i.kt)("h2",{id:"using-direct-dependency-injection"},"Using Direct Dependency Injection"),(0,i.kt)("p",null,"If your modules are coupled, you can use direct dependency injection."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Injectable } from '@graphql-modules/di';\nimport { OtherProvider } from '../my-other-module/other.provider';\n\n@Injectable()\nexport class MyProvider {\n  constructor(private otherProvider: OtherProvider) {}\n}\n")),(0,i.kt)("h2",{id:"using-injection-tokens"},"Using Injection Tokens"),(0,i.kt)("p",null,"If you wish to make a module communicate with other modules without direct imports, you can use injection tokens:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Inject, Injectable } from '@graphql-modules/di';\n\nexport interface IOtherProviderSignature {\n  doSomething: () => void;\n}\n\n@Injectable()\nexport class MyProvider {\n  constructor(\n    @Inject(MY_CLASS_TOKEN) private otherProvider: IOtherProviderSignature\n  ) {}\n}\n")),(0,i.kt)("p",null,"Then, your app or other modules can use the following to implement it:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"class MyImplementation implements IOtherProviderSignature {\n  doSomething() {\n    // ... some code ...\n  }\n}\n")),(0,i.kt)("p",null,"And provide it using ",(0,i.kt)("inlineCode",{parentName:"p"},"providers"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"{ provide: MY_CLASS_TOKEN, useClass: MyImplementation }\n")),(0,i.kt)("h2",{id:"using-a-communication-bridge-pubsub"},"Using a Communication Bridge: PubSub"),(0,i.kt)("p",null,"GraphQL Modules can work with ",(0,i.kt)("inlineCode",{parentName:"p"},"PubSub")," mechanism for dealing with messages between modules."),(0,i.kt)("p",null,"It's useful when you want to notify other modules of something, without knowing them directly."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"PubSub")," is implemented as a simple Pub/Sub mechanism for publishing/subscribing to messages."),(0,i.kt)("p",null,"First, you need to tell ",(0,i.kt)("inlineCode",{parentName:"p"},"GraphQLModule")," how to transmit your messages. ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apollographql/graphql-subscriptions"},"graphql-subscriptions")," provides a simple ",(0,i.kt)("inlineCode",{parentName:"p"},"PubSub")," implementation based on ",(0,i.kt)("inlineCode",{parentName:"p"},"EventEmitter"),"."),(0,i.kt)("p",null,"To use it, pass the ",(0,i.kt)("inlineCode",{parentName:"p"},"PubSub")," class as a provider in a shared ",(0,i.kt)("inlineCode",{parentName:"p"},"GraphQLModule")," instance:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"import { GraphQLModule } from '@graphql-modules/core';\nimport { PubSub } from 'graphql-subscriptions';\n\nconst CommonModule = new GraphQLModule({\n    providers: [\n      PubSub\n      /* ... */\n    ]\n    imports: [ /* ... */],\n});\n")),(0,i.kt)("p",null,"And import this common module when you want to use ",(0,i.kt)("inlineCode",{parentName:"p"},"PubSub"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"import { GraphQLModule } from '@graphql-modules/core';\n\nexport const FooModule = new GraphQLModule({\n  imports: [CommonModule],\n});\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"import { GraphQLModule } from '@graphql-modules/core';\n\nexport const BarModule = new GraphQLModule({\n  imports: [CommonModule],\n  providers: [MyProvider],\n});\n")),(0,i.kt)("p",null,"To use ",(0,i.kt)("inlineCode",{parentName:"p"},"PubSub"),", you can do the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Injectable } from '@graphql-modules/di';\nimport { PubSub } from 'graphql-subscriptions';\n\n@Injectable()\nexport class MyProvider {\n  constructor(private pubsub: PubSub) {\n    // Listen to messages and handle them\n    pubsub.subscribe('NOTIFY_USER', (payload) => {\n      // Do something\n    });\n  }\n\n  doSomething() {\n    // Publish messages\n    pubsub.publish('DO_SOMETHING_ELSE', {\n      foo: 'bar',\n    });\n  }\n}\n")),(0,i.kt)("p",null,"This kind of communication between modules is useful for implementing notifications, auditing, logging, etc."),(0,i.kt)("p",null,"It's also useful for implementing communication between GraphQL Modules servers. There are various PubSub implementations based on EventEmitter, Redis and RabbitMQ."),(0,i.kt)("h3",{id:"existing-implementations-for-pubsub"},"Existing Implementations for PubSub"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"PubSub")," can be replaced by another implementations. The following are existing ready-to-use implementations:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/davidyaha/graphql-redis-subscriptions"},"Redis"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/axelspringer/graphql-google-pubsub"},"Google PubSub"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/davidyaha/graphql-mqtt-subscriptions"},"MQTT enabled broker"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/cdmbase/graphql-rabbitmq-subscriptions"},"RabbitMQ"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/ancashoria/graphql-kafka-subscriptions"},"Kafka"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/GraphQLCollege/graphql-postgres-subscriptions"},"Postgres")))))}m.isMDXComponent=!0}}]);